---
title: "8.3 Who to follow"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
#Load libraries that are required
library(rtweet)
library(twitteR)

#Setting up authentication to access twitter for Q13
key = "COghWIH9VbXOtQI6m9xrSbOVN"
secret = "f0M4L0oMsvGpxcdb7MycEwxyyJC7Hub29hjnVUTEUO7oKeufsx"
access_tokens = "2388475730-lZ4Yqs8Jd3XtKZZQoTOz3wcYjypHbbnHKjwAQE1"
access_secret = "uHZHaALuELTlITgvJXR7PuG1pYGk8297RNGr8cUspO2C9"
setup_twitter_oauth(key, secret, access_tokens, access_secret)


#11
#Reading the tweets.rds file
tweets = readRDS("tweets.rds")
#Attaching the tweets to make it into a global variable
attach(tweets)
#Change the tweets that is attached to only show the top 100 tweets
tweets[1:100, ]
#Store the attached tweets into its own dataset and reorder the tweets to show the top 100 tweets that are tweeted.
top100.tweets <- tweets[order(retweet_count, decreasing=TRUE)[1:100] ,] 
#Print the top 100 tweeted tweets
print(top100.tweets)

#12
#By using the "top100.tweets" dataset, we store all the users that tweeted in the top 100 in a variable set
UsersOfTweets=top100.tweets[1:100, c("screen_name")]
#Print all the users to identify the users
print(UsersOfTweets)


#13
#By using the "UsersOfTweets" variable set we search all of the users and gather all their data and store it in the variable set "UsersData"
UsersData <- lookupUsers(c(UsersOfTweets))

#Using the "sapply" function we extract the follower counts of all the users and store it in a variable set "followersCounts"
followerCounts = sapply(UsersData, function(x) x$followersCount)

#Using the "sapply" function we extract the statuses counts of all the users and store it in a variable set "statusesCounts"
statusesCounts = sapply(UsersData, function(x) x$statusesCount)

#Print the followercounts of all users
print (followerCounts)
#Print all the statuses counts of all users
print (statusesCounts)

#14






expectedIndependent = function (X) {
  n = sum (X)
  p = rowSums(X)/sum(X)
  q = colSums(X)/sum(X)
  return(p %o% q * n)
}

chiSquaredStatistic = function(X, E) {
  return(sum((X - E)^2/E))
}

E = expectedIndependent(table(statusesCounts, followerCounts))

x2dist = replicate(100, )
{
  chiSquaredStatistic(E)
  
})

hist(x2dist)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
